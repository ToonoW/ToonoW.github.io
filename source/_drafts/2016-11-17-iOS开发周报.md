---
date: 2016-11-17
layout: post
title: iOS开发周报 【一】
category: iOS
---
# iOS开发周报

这周在开发医生查房的iPad端，现阶段在做基本的启动页和登陆页。



* [通过仿射变换实现键盘弹出并且视图上移功能](http://blog.csdn.net/lc_obj/article/details/17608475)
* [CALayer简单使用简介](http://www.cnblogs.com/wendingding/p/3800010.html)



### 简单动画

1. 头尾式动画

```objective-c
// beginAnimations 表示此后的代码要参与到动画中
[UIView beginAnimations:nil context:nil];
// 设置动画持续时间
[UIView setAnimationDuration:0.5];

self.testView.frame = CGRectMake(screenW, screenH, 100, 100);

// commitAnimations,将beginAnimation之后的所有动画提交并生成动画
[UIView commitAnimations];
```

说明：如果只是修改控件的属性，使用首尾式动画还是比较方便的，但是如果需要在动画完成后做后续处理，就不是那么方便了



2. block 动画

```objective-c
CGFloat screenW = [UIScreen mainScreen].bounds.size.width - 120;
    CGFloat screenH = [UIScreen mainScreen].bounds.size.height - 120;

    [UIView animateWithDuration:0.7 animations:^{
        self.testView.frame = CGRectMake(screenW, screenH, 100, 100);
    } completion:^(BOOL finished) {
        self.testView.backgroundColor = [UIColor blueColor];
    }];
```

说明：
（1）在实际的开发中更常用的时block代码块来处理动画操作。
（2）块动画相对来说比较灵活，尤为重要的是能够将动画相关的代码编写在一起，便于代码的阅读和理解.



3. 序列帧动画

```objective-c
 UIImageView *img = [[UIImageView alloc]init];

    //这里把要执行动画的图片存放到数组中即可 
    NSMutableArray *arrayM = [NSMutableArray array];

    // 给图片框设置图片数组
    [img setAnimationImages:arrayM];

    // 设置动画播放时间
    [img setAnimationDuration:arrayM.count * 0.075];

    // 设置重复次数(默认是0)
    [img setAnimationRepeatCount:1];

    // 开始动画
    [img startAnimating];

    // 停止动画
    [img stopAnimating];

    // 动画是否在执行
    BOOL isAnim = [img isAnimating];
```

说明:
项目中使用序列帧动画,要考虑程序性能,(内存暴涨)播放动画以后要清空图片数组.



### 绘制阴影

    // 绘制阴影
    self.layer.masksToBounds = NO;
    // 阴影的偏移
    self.layer.shadowOffset = CGSizeMake(0, 0);
    // 阴影半径
    self.layer.shadowRadius = 10;
    // 阴影透明度
    self.layer.shadowOpacity = 0.5;
    // 添加了这句话好多阴影都不卡顿了。减少了离屏渲染的计算，提高性能
    self.layer.shadowPath = [UIBezierPath bezierPathWithRect:self.bounds].CGPath;


### view的图层上添加图片

`self.layer.contents=(id)[UIImage imageNamed:@"me"].CGImage;`



### 调整navigationbaritems之间的间距

在初始化一个新的空白`navigationbaritem`的时候设置其`style`为`UIBarButtonSystemItemFixedSpace`，这样子创建一个直有`width`的baritem来调整两个baritem之间的间距。另外`UIBarButtonSystemItemFixedSpace`的`width`值可以为负数。



### 在同一个UIView实现阴影和圆角效果

因为在`masksToBounds = NO`情况下阴影有效而圆角无效，而在`masksToBounds = YES`情况下圆角有效而阴影无效。所以我们不能单单控制同一个view的layer去同时实现阴影和圆角效果。

实现思路：我们添加一个子view到需要做阴影和圆角效果的父view的最底部，用它去实现圆角效果。而原本的父view则将背景色设置为透明，然后负责实现阴影效果。代码如下。

```objective-c
- (void)drawRect:(CGRect)rect {
    // 绘制阴影
    self.layer.shadowColor = [UIColor colorWithRed:113/255.0 green:113/255.0 blue:113/255.0 alpha:1].CGColor;
    self.layer.shadowRadius = 4.0;
    self.layer.shadowOpacity = 0.16;
    self.layer.shadowOffset = CGSizeMake(-2, -2);
    self.layer.masksToBounds = NO;
    
    
    // 设置圆角
    [self setBackgroundColor:[UIColor clearColor]];
    
    UIView *cornerRadiusView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, self.frame.size.width, self.frame.size.height)];
    [cornerRadiusView setBackgroundColor:[UIColor colorWithRed:247/255.0 green:247/255.0 blue:245/255.0 alpha:1.0]];
    cornerRadiusView.layer.masksToBounds = YES;
    cornerRadiusView.layer.cornerRadius = 10.0;
    [self insertSubview:cornerRadiusView atIndex:0];

}
```

![效果图](http://ww4.sinaimg.cn/large/65e4f1e6gw1fa0wadhfzgj21kw16o49w.jpg)
